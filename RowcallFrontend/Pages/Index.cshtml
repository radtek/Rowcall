@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}


<div class="row">
    <div class="col-6 mx-auto">
        <div class="login-container">
            <h2>Teacher login</h2>
            <hr />
            <form id="teacherLoginForm">
                <div class="form-group">
                    <label for="formGroupExampleInput">Email:</label>
                    <input type="email" class="form-control" id="formGroupExampleInput" placeholder="Email">
                </div>
                <div class="form-group">
                    <label for="formGroupExampleInput2">Password</label>
                    <input type="password" class="form-control" id="formGroupExampleInput2" placeholder="Email">
                </div>
                <button type="button" class="btn btn-primary mb-2" id="teacherLoginBtn">Login</button>
            </form>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(window).ready(function () {
            if (getCookie("token")) {
                window.location.href = "/Teacher";
            }
        });

        $(document).ready(function () {

            $("#teacherLoginBtn").click(function () {
                var email = $("#formGroupExampleInput").val();
                var pass = $("#formGroupExampleInput2").val(); 

                var data = { 
                    email: email,
                    password: pass
                };

                $.ajax({
                    url: "http://localhost:2265/account/login",
                    method: "POST",
                    dataType: 'json',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    data: JSON.stringify(data),
                    success: function (response) {

                        if (response.succeded) {
                            console.log(true);
                            document.cookie = "token=" + response.response
                            console.log(getCookie("token"))
                            window.location.href = "/Teacher";
                        } else {
                            console.log(false);
                        }

                        console.log(response);
                    },
                    error: function (error) {
                        console.log(error);
                    }

                });

            });

        });

    </script>

}